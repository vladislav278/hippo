{% extends 'base.html' %}
{% load static %}

{% block title %}–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç –≤—Ä–∞—á–∞ - {{ block.super }}{% endblock %}

{% block content %}
<div class="container">
    <div class="cabinet-header">
        <h1>–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç –≤—Ä–∞—á–∞</h1>
        <p class="user-info">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, {{ user.email }}</p>
    </div>

    <div class="stats-grid">
        <div class="stat-card">
            <div class="stat-icon">üë•</div>
            <div class="stat-content">
                <h3>{{ total_patients }}</h3>
                <p>–ü–∞—Ü–∏–µ–Ω—Ç–æ–≤</p>
            </div>
        </div>
        <div class="stat-card">
            <div class="stat-icon">üìã</div>
            <div class="stat-content">
                <h3>{{ total_records }}</h3>
                <p>–ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö –∫–∞—Ä—Ç–æ—á–µ–∫</p>
            </div>
        </div>
        <div class="stat-card">
            <div class="stat-icon">üè•</div>
            <div class="stat-content">
                <h3>{{ user.hospital.name|default:"–ù–µ —É–∫–∞–∑–∞–Ω–∞" }}</h3>
                <p>–ë–æ–ª—å–Ω–∏—Ü–∞</p>
            </div>
        </div>
        <div class="stat-card">
            <div class="stat-icon">üë®‚Äç‚öïÔ∏è</div>
            <div class="stat-content">
                <h3>{{ user.get_role_display }}</h3>
                <p>–†–æ–ª—å</p>
            </div>
        </div>
    </div>

    <div class="content-grid">
        <div class="content-section">
            <h2>–ü–æ—Å–ª–µ–¥–Ω–∏–µ –ø–∞—Ü–∏–µ–Ω—Ç—ã</h2>
            {% if recent_patients %}
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>–§–ò–û</th>
                                <th>–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è</th>
                                <th>–¢–µ–ª–µ—Ñ–æ–Ω</th>
                                <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for patient in recent_patients %}
                            <tr>
                                <td>{{ patient.full_name }}</td>
                                <td>{{ patient.date_of_birth|date:"d.m.Y" }}</td>
                                <td>{{ patient.phone|default:"‚Äî" }}</td>
                                <td>
                                    <a href="{% url 'admin:patients_patient_change' patient.id %}" class="btn btn-sm">–ü–æ–¥—Ä–æ–±–Ω–µ–µ</a>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            {% else %}
                <p class="empty-state">–ù–µ—Ç –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤</p>
            {% endif %}
            <a href="{% url 'admin:patients_patient_changelist' %}" class="btn btn-primary">–í—Å–µ –ø–∞—Ü–∏–µ–Ω—Ç—ã</a>
        </div>

        <div class="content-section">
            <h2>–ü–æ—Å–ª–µ–¥–Ω–∏–µ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ –∫–∞—Ä—Ç–æ—á–∫–∏</h2>
            {% if recent_records %}
                <div class="records-list">
                    {% for record in recent_records %}
                    <div class="record-card">
                        <div class="record-header">
                            <h4>{{ record.patient.full_name }}</h4>
                            <span class="record-date">{{ record.visit_date|date:"d.m.Y" }}</span>
                        </div>
                        <div class="record-content">
                            <p><strong>–ñ–∞–ª–æ–±—ã:</strong> {{ record.chief_complaint|truncatewords:20 }}</p>
                            {% if record.diagnosis %}
                                <p><strong>–î–∏–∞–≥–Ω–æ–∑:</strong> {{ record.diagnosis }}</p>
                            {% endif %}
                        </div>
                        <div class="record-actions">
                            <a href="{% url 'admin:patients_medicalrecord_change' record.id %}" class="btn btn-sm">–ü–æ–¥—Ä–æ–±–Ω–µ–µ</a>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            {% else %}
                <p class="empty-state">–ù–µ—Ç –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö –∫–∞—Ä—Ç–æ—á–µ–∫</p>
            {% endif %}
            <a href="{% url 'admin:patients_medicalrecord_changelist' %}" class="btn btn-primary">–í—Å–µ –∫–∞—Ä—Ç–æ—á–∫–∏</a>
        </div>
    </div>

    <div class="quick-actions">
        <h2>–ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è</h2>
        <div class="actions-grid">
            <a href="{% url 'admin:patients_patient_add' %}" class="action-card">
                <div class="action-icon">‚ûï</div>
                <h3>–î–æ–±–∞–≤–∏—Ç—å –ø–∞—Ü–∏–µ–Ω—Ç–∞</h3>
                <p>–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å –æ –ø–∞—Ü–∏–µ–Ω—Ç–µ</p>
            </a>
            <a href="{% url 'admin:patients_medicalrecord_add' %}" class="action-card">
                <div class="action-icon">üìù</div>
                <h3>–°–æ–∑–¥–∞—Ç—å –∫–∞—Ä—Ç–æ—á–∫—É</h3>
                <p>–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é –º–µ–¥–∏—Ü–∏–Ω—Å–∫—É—é –∫–∞—Ä—Ç–æ—á–∫—É</p>
            </a>
            <a href="{% url 'admin:index' %}" class="action-card">
                <div class="action-icon">‚öôÔ∏è</div>
                <h3>–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</h3>
                <p>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã–º–∏</p>
            </a>
        </div>
    </div>
</div>
{% endblock %}

